let galleryItems=document.querySelectorAll(".gallery img"),galleryPictures=[],container=document.querySelector(".container"),gallery=document.querySelector(".gallery"),modalPictures=[],currentModal=null,focusables=[],index=0,previouslyFocusedElement=null;galleryItems.forEach(e=>{let t=e.getAttribute("src").replace("-424px",""),l=e.getAttribute("alt"),r=e.getAttribute("data-tag");galleryPictures[index]={src:t,thumbSrc:e.getAttribute("src"),alt:l,tag:r,index:index},e.setAttribute("index",index),modalPictures.push([t,l,r]),e.addEventListener("click",e=>{openModal(parseInt(e.target.getAttribute("index")))}),index++});let tagList=[];for(let i=0;i<modalPictures.length;i++)tagList.includes(modalPictures[i][2])||tagList.push(modalPictures[i][2]);let catContainer=document.querySelector(".filters-container"),catBtn=document.createElement("button");catBtn.setAttribute("class","cat-filter-btn");let allBtn=catBtn.cloneNode();for(allBtn.classList.add("active"),allBtn.setAttribute("role","tab"),allBtn.setAttribute("aria-label","All works"),allBtn.setAttribute("aria-controls","gallery-items"),allBtn.innerHTML="Tous",allBtn.addEventListener("click",e=>{e.preventDefault(),gallery.innerHTML="",activate(e),displayPictures(galleryPictures)}),catContainer.appendChild(allBtn),i=0;i<tagList.length;i++){let e=catBtn.cloneNode();e.setAttribute("role","tab"),e.setAttribute("aria-label",tagList[i]+" works"),e.setAttribute("aria-controls","gallery-items"),e.innerHTML=tagList[i],e.addEventListener("click",e=>{let t=galleryPictures.filter(t=>t.tag===e.target.innerHTML);e.preventDefault(),document.querySelector(".gallery").innerHTML="",activate(e),displayPictures(t)}),catContainer.appendChild(e)}function activate(e){catContainer.querySelector(".active").classList.remove("active"),e.target.classList.add("active")}function displayPictures(e){let t=document.querySelector(".gallery");t.classList.remove("slide"),t.classList.add("hide"),setTimeout(()=>{for(let l of e){let r=`<img class="gallery-img" data-tag="${l.tag}" src="${l.thumbSrc}" alt="${l.alt}" index="${l.index}">`;t.innerHTML+=r}t.classList.remove("hide"),t.classList.add("slide");t.querySelectorAll("img").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),openModal(parseInt(e.target.getAttribute("index")))})})},100)}function openModal(e){currentModal=e;let t=document.querySelector(".modal-window");t.style.display=null,t.removeAttribute("aria-hidden"),t.setAttribute("aria-modal","true"),t.addEventListener("click",closeModal),t.classList.add("show");let l=t.querySelector(".modal-backdrop");l.style.display="block",l.classList.add("show"),previouslyFocusedElement=document.querySelector(":focus"),focusables=Array.from(t.querySelectorAll("button, a, input, textarea, select"));let r=document.querySelector(".modal-content");r.style.display="block",r.classList.add("show"),r.addEventListener("click",e=>{e.stopPropagation()}),updateModalDisplay(e);let a=r.querySelector(".modal-prev"),o=r.querySelector(".modal-next");a.addEventListener("click",e=>prev()),o.addEventListener("click",e=>next())}function closeModal(){let e=document.querySelector(".modal-window"),t=document.querySelector(".modal-content"),l=t.querySelector(".modal-prev"),r=t.querySelector(".modal-next");e.querySelector(".modal-backdrop").classList.remove("show"),e.classList.remove("show"),t.classList.remove("show"),setTimeout(()=>{l.removeEventListener("click",e=>prev()),r.removeEventListener("click",e=>next()),t.removeEventListener("click",e=>{e.stopPropagation()});let a=t.querySelector("img");a.setAttribute("src",""),a.setAttribute("alt",""),null!==previouslyFocusedElement&&previouslyFocusedElement.focus(),e.setAttribute("aria-hidden",!0),e.removeAttribute("aria-modal","true"),e.removeEventListener("click",closeModal),e.style.display="none"},290),currentModal=null}function updateModalDisplay(e){let t=document.querySelector(".modal-content").querySelector("img");t.setAttribute("src",modalPictures[e][0]),t.setAttribute("alt",modalPictures[e][1])}function prev(){-1==--currentModal&&(currentModal=8),updateModalDisplay(currentModal)}function next(){9==++currentModal&&(currentModal=0),updateModalDisplay(currentModal)}container.prepend(catContainer),window.addEventListener("keydown",function(e){("Escape"===e.key||"Esc"===e.key)&&closeModal(e),"Tab"===e.key&&null!==currentModal&&focusInModal(e)});const focusInModal=function(e){e.preventDefault();let t=document.querySelector(".modal-window").querySelector(".modal-content");t.querySelector(":focus");let l=focusables.findIndex(e=>e===t.querySelector(":focus"));void 0===l&&(l=0),!0===e.shiftKey?l--:l++,l>=focusables.length&&(l=0),l<0&&(l=focusable.length-1),focusables[l].focus()};